---
title: "Lab 7 assignment, group 24"
author: "Group 24"
format: html
editor: visual
---

## Group 24

**Group members:**

Helena Utzon , S153655

Christian Hussing, S150251

Pernille Renkwitz, s204637

Inmaculada Echegoyan Venegas, s253701

Lanjing Buisan Fernandez, s256855

### Plan for report

Data: gravier

Import and data wrangling:

Analysis: Everyone contributes with a graph or something else

### Load libraries

```{r}
#| message: false  
library(tidyverse) 
library(broom) 
library(ggrepel)
```

### Load data

Load data:

```{r}
raw_dir <- "data/"
data_file <- "gravier.RData"
data_loc <- "https://github.com/ramhiser/datamicroarray/raw/master/data/"

if( !dir.exists(raw_dir) ){
  dir.create(path = raw_dir)
}
if( !file.exists(str_c(raw_dir, data_file)) ){
  download.file(
    url = str_c(data_loc, data_file),
    destfile = str_c(raw_dir, data_file))
}
load(file = str_c(raw_dir, data_file))
gravier
```

Clean and augment data:

```{r}
gravier_clean <- gravier |>
  bind_cols() |>
  as_tibble()

gravier_clean_aug <- gravier_clean |>
  mutate(y = case_when(y == "poor" ~ 1,
                       y == "good" ~ 0)) |> 
  relocate(early_metastasis = y)
gravier_clean_aug
```

### Data wrangling

The data is transformed to long data:

```{r}
gravier_clean_aug_long <- gravier_clean_aug |> 
  pivot_longer(
  cols = starts_with("g"),
  names_to = "gene",
  values_to = "log2_expr_level"
  )
gravier_clean_aug_long

```

```{r}
gravier_mean_gene_expression <- gravier_clean_aug_long |> group_by(gene, early_metastasis) |>
  summarise(mean_gene_expression = round(mean(log2_expr_level), 4))
gravier_mean_gene_expression
```
